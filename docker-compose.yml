version: '3.8'

# Docker Compose for Local Development
# This file is designed for easy local testing and development.
# It uses host networking for simplified SIP/RTP communication
# and mounts the local code directory for live updates.

services:
  callie-caller:
    build:
      context: .
      dockerfile: Dockerfile.prod
    image: callie-caller-dev:latest
    container_name: callie-caller
    restart: unless-stopped
    
    # Use host networking to avoid complex port mapping for SIP/RTP.
    # This makes the container share the host's network stack.
    network_mode: "host"
    
    # Load environment variables from a local .env file.
    # Create a .env file from config.env.template and fill in your secrets.
    env_file:
      - .env
      
    # Mount the local directory into the container for live code reloading.
    # This allows you to change the Python code and see changes without
    # rebuilding the Docker image.
    volumes:
      - .:/app
      
    # Add any additional environment variables needed for development here.
    environment:
      - LOG_LEVEL=DEBUG
      - USE_WEB_UI=true
      
volumes:
  callie_logs:
  callie_audio: 